# 7. AI Integration

The Discovery Engine is not just a repository of knowledge — it is an **active reasoning environment**. At the heart of this environment are **AI agents** that operate directly on the CNM (Conceptual Nexus Model), using structured knowledge representations to support synthesis, discovery, and hypothesis generation.

---

## 7.1 Role of AI in the System

AI agents serve as:

| Role                        | Description                                                                    |
|-----------------------------|--------------------------------------------------------------------------------|
| **Navigators**              | Traverse and explore the knowledge graph to identify patterns and clusters     |
| **Analysts**                | Perform link prediction, conflict detection, and statistical summarisation     |
| **Designers**               | Generate new structured hypotheses or conceptual artifacts                     |
| **Assistants**              | Respond to user queries, surface related concepts, and recommend experiments   |

These agents are not generic LLMs generating text in isolation — they are **grounded** in a structured, provenance-rich knowledge substrate.

---

## 7.2 Agent Input Contexts

Each agent interacts with one or more of the following structured views:

| Input Context              | Description                                                                 |
|----------------------------|-----------------------------------------------------------------------------|
| **CNM Subgraph**           | A slice of the knowledge graph relevant to a concept or method              |
| **Tensor Projection (TCNM)** | Encodes high-dimensional semantic relationships among artifacts             |
| **Vector Embedding Space** | For soft similarity, analogy, and clustering tasks                         |
| **Provenance Chains**      | Linked document segments and metadata for validation and traceability       |

Agents choose the representation that best supports the reasoning task at hand.

---

## 7.3 Agent Operations

### 1. **Graph-Based Inference**

- Walk the CNM to:
  - Identify transitive causal chains
  - Detect centrality or bridge nodes
  - Aggregate all supporting evidence for a claim

### 2. **Tensor Algebra & Completion**

- Operate on TCNM to:
  - Infer likely missing relationships (tensor completion)
  - Generate latent semantic associations (via contraction or projection)
  - Detect inconsistencies in relational structure

### 3. **Vector Search & Analogy**

- Retrieve nearest-neighbours to:
  - Find analogues in other domains
  - Group similar mechanisms or parameter sets
  - Detect “semantic twins” — different names for similar ideas

### 4. **Knowledge Gap Detection**

- Use graph sparsity + tensor slicing to:
  - Identify unconnected but structurally adjacent nodes
  - Flag missing parameter values or undefined mechanisms
  - Suggest areas for experiment or theory generation

### 5. **Generative Hypothesis Design**

- Compose new artifacts from:
  - Analogies to existing patterns
  - Constraint satisfaction over parameters
  - Formal templates (e.g. "If X causes Y and Z is similar to X…")

---

## 7.4 Agent Capabilities Matrix

| Capability                | Graph | Tensor | Embedding | Provenance |
|---------------------------|-------|--------|-----------|------------|
| Concept Expansion         | ✅    | ✅     | ✅        | ❌         |
| Analogy Detection         | ❌    | ✅     | ✅        | ❌         |
| Contradiction Flagging    | ✅    | ✅     | ❌        | ✅         |
| Hypothesis Generation     | ✅    | ✅     | ✅        | ❌         |
| Confidence Estimation     | ✅    | ❌     | ❌        | ✅         |
| Constraint Resolution     | ✅    | ✅     | ❌        | ❌         |
| Multi-hop Reasoning       | ✅    | ❌     | ❌        | ❌         |

---

## 7.5 Agent Types

| Agent Name         | Function Description                                                         |
|--------------------|------------------------------------------------------------------------------|
| **Navigator**       | Explores CNM structure to surface relevant concepts and papers              |
| **Synthesiser**     | Aggregates multiple artifacts into a higher-level hypothesis or design       |
| **GapFinder**       | Identifies missing links or unexplored connections                          |
| **Contradictor**    | Flags claims that are in tension or opposition with others                   |
| **Designer**        | Creates new structured artifacts (hypotheses, methods, parameter models)     |
| **Verifier**        | Checks coherence, completeness, and provenance for a given artifact cluster  |

These agents can be composed into **multi-agent workflows** for advanced tasks like literature review automation or research roadmap synthesis.

---

## 7.6 Example Use Cases

### Use Case 1: Parameter Inference

> Task: "What parameter values are typically used for photothermal activation in soft robotics?"

- Agent performs:
  - Graph walk on `MethodNode → ParameterNode`
  - Embedding clustering for equivalent mechanisms
  - Statistical summarisation of parameter ranges

---

### Use Case 2: Hypothesis Suggestion

> Task: "Propose a hypothesis for intelligent behaviour in material X"

- Agent pipeline:
  - GapFinder identifies missing causal edges for material X
  - Synthesiser composes plausible links from similar materials
  - Designer generates a hypothesis artifact
  - Verifier checks for provenance similarity and novelty

---

## 7.7 Limitations and Mitigations

| Limitation                     | Mitigation Strategy                                                 |
|--------------------------------|----------------------------------------------------------------------|
| Spurious analogies             | Constraint filtering + evidence weighting                           |
| Overfitting to local structure | Include global tensor context + provenance checks                   |
| Semantic drift                 | Schema-based validation + embedding retraining                      |
| Agent opacity                  | All agent outputs include explanation chain + source paths          |

---

## 7.8 Towards Reflective Agents

Future versions of agents will be able to:

- Assess the reliability of their own outputs
- Request refinement of the underlying templates or schemas
- Compose new types of questions or data structures to better represent unknowns

This enables the Discovery Engine to act as a **co-researcher**, not just a tool.

---

> ☑️ Visual prompt for napkin.ai:
>
> **Title**: “AI Agent Layer in the Discovery Engine”
>
> - Central block: “AI Agents” 🤖
> - Arrows from three inputs:
>     - “CNM Graph View” 🌐
>     - “TCNM Tensor” 🧮
>     - “Embedding Space” 🌌
>
> - Agents shown as modular units:
>     - Navigator 🧭
>     - Synthesiser 🧠
>     - GapFinder 🔍
>     - Contradictor ⚖️
>     - Designer 🧬
>     - Verifier ✅
>
> - Outputs:
>     - New Artifacts 📄
>     - Flagged Gaps ❗
>     - Suggested Hypotheses 💡
>     - Ranked Clusters 📊
